#user  nobody;
worker_processes  1;

events {
    worker_connections  1024;
}

http {
        include       mime.types;
        default_type  application/octet-stream;

   	log_format  main escape=json '$http_host - $remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for" "$http_x_ca_app_version" "$http_x_ca_stage" $request_body';
        #access_log  logs/access.log  main;

        sendfile        on;
        #tcp_nopush     on;

        #keepalive_timeout  0;
        keepalive_timeout  120;

        gzip on;
        gzip_min_length 1k;
        gzip_buffers 4 16k;
        gzip_http_version 1.0;
        gzip_comp_level 2;
        gzip_vary on;
        gzip_proxied any;

        client_max_body_size    300m;
        client_body_buffer_size 256k;
	client_header_buffer_size 256k;
	large_client_header_buffers 4 256k;

        add_header X-Request-ID $request_id; # Return to client
        add_header X-B3-TraceId $request_id;
        add_header X-B3-SpanId $request_id;

        proxy_next_upstream     error timeout;
        proxy_redirect          off;
        proxy_set_header        Host $host;
        proxy_set_header        X-Real-IP $http_x_forwarded_for;
        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header        X-Forwarded-Proto $scheme;
        proxy_set_header        X-Request-ID $request_id; #Pass to app server
        proxy_set_header        X-B3-TraceId $request_id;
        proxy_set_header        X-B3-SpanId $request_id;
        proxy_connect_timeout   180;
        proxy_send_timeout      180;
        proxy_read_timeout      180;
        proxy_buffer_size       8k;
        proxy_buffers           8 64k;
        proxy_busy_buffers_size 128k;
        proxy_temp_file_write_size 128k;
        proxy_http_version 1.1;
       	proxy_set_header Connection "";
        server_names_hash_bucket_size 512;
        ssl_session_cache   shared:SSL:10m;
        ssl_session_timeout 10m;


# ***************************项目管理***********************************************************************************
        upstream wtctest{
                server 10.30.212.173:25002;
        }
        upstream wtcdev{
                server 10.30.179.199:25001;
        }

        upstream hrmdev{
                server 10.30.177.111:7001;
        }
        upstream hrmtest{
                server 10.31.242.110:7002;
        }

        upstream eurekadev{
                server 10.30.177.111:10761;
        }
        upstream cAdvisor{
                server 10.30.177.111:8080;
        }
        upstream eurekatest{
                server 10.29.243.231:20761;
                server 10.30.212.173:20761;
        }
        upstream snsconsoledev{
                server 10.30.177.111:9001;
        }
        upstream snsconsoletest{
                server 10.31.242.110:9002;
        }
        upstream rwatcher_native{
                #server 10.31.242.110:6000;
                server 223.85.203.80:20100;
        }
        upstream rwatcher_new_test{
                server 192.168.100.71:20100;
        }
		
        upstream doctordev{
                server 10.30.177.111:31020;
        }
        upstream doctortest{
                server 10.29.243.231:31020;
        }

        upstream patientdev{
                server 10.30.177.111:31050;
        }
        upstream patienttest{
                server 10.30.212.173:12002;
        }
        upstream sportdev{
                server 10.30.177.111:31050;
        }
        upstream sporttest{
                server 10.29.243.231:31050;
        }
	upstream xcxdev{
        	server 10.129.23.116:8989;
	} 
        upstream jenkins2{
                server 10.30.179.199:9528;
        }
        upstream jenkins{
                server 192.168.100.71:8082;
        }
        upstream git {
                server 10.30.212.173:8081;
        }
        upstream gerrit{
                server 10.30.212.173:8081;
        }

        upstream oamdev {
                server 10.30.177.111:31040;
        }
        upstream oamtest {
                server 10.30.212.173:15002;
        }

	upstream tokencentraldev {
                server 10.30.179.199:6001;
        }
	upstream tokencentraltest {
                server 10.30.212.173:6002;
        }
	
	upstream wechatactivitydev{
		server 10.30.177.111:17001;
	}

	upstream wechatactivitytest{
		server 10.30.212.173:17002;
	}
	

        upstream operationactivitiesdev{
		server 10.30.177.111:16001;
	}

	upstream operationactivitiestest{
		server 10.31.242.110:16002;
	}

        upstream mallcoredev {
                server   10.30.177.111:7272;
        }

        upstream mallcoretest {
                server   10.31.242.110:7272;
        }

        upstream mallsitedev {
                server   10.30.177.111:10080;
        }

        upstream mallsitetest {
                server   10.31.242.110:10080;
        }

        upstream rpluscoredev {
                server   10.30.177.111:7373;
        }
        upstream rpluscoretest {
                server   10.31.242.110:7373;
        }

        upstream rplusdev {
                server   10.30.177.111:18080;
        }

        upstream rplustest {
                server   10.31.242.110:18080;
        }
	
	upstream snstest{
		server 192.168.100.71:8102;
	}
	upstream snsdev{
		server 10.30.212.159:8101;
	}
	
	upstream wiki{
		server 10.30.179.199:18090;
	}
	
	upstream sonar{
		server 10.30.179.199:9000;
	}
	upstream miniprogramdev{
		server 223.85.203.80:8666;
	}
	upstream rwatcherintldev{
		server 192.168.100.72:20100;
	}
	upstream rwatcherintltest{
		server 192.168.100.71:20100;
		#server 223.85.203.80:20100;
	}
	
	server {
                listen 80 default_server;
                server_name  default.suifangyun.com;
                access_log logs/default.suifangyun.com.log main;
                location / {
                        return 200 'please use https';
                }
        }
	server {
                listen 80;
                server_name  wiki.suifangyun.com;
                access_log logs/wiki.suifangyun.com.log main;
                location / {
                        root html;
                        proxy_pass http://wiki;
                }
        }


        server {
                listen 443 ssl;
                server_name  miniprogram.shukangyun.com;
                access_log logs/miniprogram.shukangyun.com.log main;
                ssl_certificate     ssl/miniprogram.shukangyun.com.crt;
                ssl_certificate_key  ssl/miniprogram.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                        proxy_pass http://miniprogramdev;
                }
                location ^~ /ndPHxZXgNl.txt{
                        root html;
                }
        }
        server {
                listen 443 ssl;
                server_name  rwatcherintl.suifangyun.com;
                access_log logs/rwatcherintl.suifangyun.com  main;
                ssl_certificate     ssl/rwatcherintl.suifangyun.com.crt;
                ssl_certificate_key  ssl/rwatcherintl.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                        proxy_pass http://rwatcherintldev;
                }
                location /api/organizations {
                        proxy_pass http://orgdev;
                }
        }


	server {
                listen 80;
                server_name  sonar.suifangyun.com;
                access_log logs/sonar.suifangyun.com.log main;
                location / {
                        proxy_pass http://sonar;
                }
        }
        server {
                listen 443 ssl;
                server_name mall.shukangyun.com;
                access_log logs/mall.shukangyun.com.log main;
                ssl_certificate     ssl/mall.shukangyun.com.crt;
                ssl_certificate_key  ssl/mall.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
		ssl_prefer_server_ciphers  on;
                #proxy_set_header X-Forwarded-For "10.30.212.173";
                proxy_redirect http:// https://;
                location / {
			root html;
			index home.html;
                        proxy_pass http://mallsitedev;
                }
                location ^~ /postopmall-core/ {
                        proxy_pass http://mallcoredev;
                }
	}
	#在微信里向医生报到授权后的回调地址
	server {
        	listen    80;
        	server_name  weixin.suifangyun.com;
        	access_log logs/weixin.suifangyun.com main;
        	location / {
                        proxy_pass http://doctortest;
        	}

		location ^~ /callback{
			root html/weixin.suifangyun.com/;
			index callback.html;
		}
                location ^~ /MP_verify_1rl2AZ6S53LYGG28.txt {
                        root html/weixin.suifangyun.com/;
                }
                location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }

        	location ^~ /services/third/api {
                        root html;
        	}
	}
	server {
        	listen    443;
        	server_name  weixin.suifangyun.com;
        	access_log logs/weixin.suifangyun.com main;
                ssl_certificate     ssl/weixin.suifangyun.com.crt;
                ssl_certificate_key  ssl/weixin.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
		ssl_prefer_server_ciphers  on;
        	location / {
                        proxy_pass http://doctortest;
        	}

		location ^~ /callback{
			root html/weixin.suifangyun.com/;
			index callback.html;
		}
                location ^~ /MP_verify_1rl2AZ6S53LYGG28.txt {
                        root html/weixin.suifangyun.com/;
                }

        	location ^~ /services/third/api {
                        root html;
        	}
	}
	server {
        	listen    80;
        	server_name  weixin.shukangyun.com;
        	access_log logs/weixin.shukangyun.com main;
        	location / {
                        proxy_pass http://doctordev;
        	}
        	location ^~ /services/third/api {
                        root html;
        	}
	}
	server {
                listen 80;
                server_name  rplus.shukangyun.com;
                access_log logs/rplus.shukangyun.com.log main;
		location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
		location / {
			root html;
                        index recoveryplus-site/home.html;
			proxy_set_header   Host $host;
                        proxy_pass http://rplusdev;
                }
		location ^~ /recoveryplus-core {
			proxy_pass http://rpluscoredev;
			proxy_set_header Host $host;
		}
        }
        server {
                listen 443 ssl;
                server_name  rplus.shukangyun.com;
                access_log logs/rplus.shukangyun.com.log main;
                ssl_certificate     ssl/rplus.shukangyun.com.crt;
                ssl_certificate_key  ssl/rplus.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
		ssl_prefer_server_ciphers  on;
                proxy_redirect http:// https://;
                location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
                location / {
                        root html;
                        index recoveryplus-site/home.html;
                        proxy_set_header   Host $host;
                        proxy_pass http://rplusdev;
                }
                location ^~ /recoveryplus-core {
                        proxy_pass http://rpluscoredev;
                        proxy_set_header Host $host;
                }
        }

        server {
                listen 443 ssl;
                server_name mall.suifangyun.com;
                access_log logs/mall.suifangyun.com.log main;
                ssl_certificate     ssl/mall.suifangyun.com.crt;
                ssl_certificate_key  ssl/mall.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
		ssl_prefer_server_ciphers  on;
                proxy_redirect http:// https://;
                proxy_set_header X-real-ip $remote_addr;
                #proxy_set_header X-Forwarded-For "10.30.212.173";
		proxy_set_header Host $host;
		location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
		location ^~ /ndPHxZXgNl.txt{
                        root html;
                }
		location ^~ /1525142864.txt {
                        root html;
                }
		#location = /{
		#	 proxy_pass http://mallsitetest/home.html;
		#}
		location / {
                        proxy_redirect http:// https://;
			proxy_pass http://mallsitetest;
                }
                location ^~ /postopmall-core/ {
                        proxy_redirect http:// https://;
			proxy_pass http://mallcoretest;
                }
	}
        upstream mallCore{
                server 10.29.164.234:7272;
                server 10.46.208.239:7272;
        }
        upstream mallSite{
                server 10.29.164.234:10080;
                server 10.46.208.239:10080;
        }
	
        server {
                listen 443 ssl;
                server_name rplus.suifangyun.com;
                access_log logs/rplus.suifangyun.com.log main;
                ssl_certificate     ssl/rplus.suifangyun.com.crt;
                ssl_certificate_key  ssl/rplus.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
		ssl_prefer_server_ciphers  on;
		location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
		location ^~ /1525142864.txt {
                        root html;
                }
		location / {
			root html;
                        index recoveryplus-site/home.html;
			proxy_set_header   Host $host;
                        proxy_pass http://rplustest;
                }
                location ^~ /recoveryplus-core/  {
                        proxy_pass http://rpluscoretest;
                }
                location ^~ /recoveryplus-booking/ {
                        proxy_pass http://rplustest;
        	}
	}

        server {
                listen 80;
                server_name  mall.suifangyun.com;
                access_log logs/mall.suifangyun.com.log main;
                location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
		location ^~ /1525142864.txt {
                        root html;
                }
	}


	server {
                listen 80;
                server_name  rplus.suifangyun.com;
                access_log logs/rplus.suifangyun.com.log main;
		location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt{
                        root html;
                }
		location ^~ /1525142864.txt {
                        root html;
                }
		location / {
			root html;
                        index recoveryplus-site/home.html;
			proxy_set_header   Host $host;
                        proxy_redirect http:// https://;
                        proxy_pass http://rplustest;
                }
                location ^~ /recoveryplus-core/  {
                        proxy_pass http://rpluscoretest;
                }
                location ^~ /recoveryplus-booking/ {
                        proxy_pass http://rplustest;
		}
        }
	
	server {
                listen 80;
                server_name  wtc.shukangyun.com;
                access_log logs/wtc.shukangyun.com.log main;
                location / {
                        proxy_pass http://wtcdev;
                }
        }
 	server {
                listen 80;
                server_name  wtc.suifangyun.com;
                access_log logs/wtc.suifangyun.com.log main;
                location / {
                        proxy_pass http://wtctest;
                }
		location ^~ /api/publicNumber/accessToken {
                	root html;
                }
                location ^~ /api/publicNumber/jsApiTicket {
                	root html;
                }
                location ^~ /api/thirdPartyPlatform/accessToken {
                	root html;
                }
                location ^~ /api/thirdPartyPlatform/authorizerAccessToken {
                	root html;
                }
                location ^~ /api/thirdPartyPlatform/authorizerJsApiTicket {
                	root html;
                }
        }
	server {
		listen 80;
                server_name  hrm.shukangyun.com;
                access_log logs/hrm.shukangyun.com.log main;
                location / {
                                proxy_pass http://hrmdev;
                                proxy_http_version 1.1;
				proxy_set_header Host $host;
                }
	#    websocket service
        	location ^~/wsapp/ {
                	proxy_read_timeout 360;
                	proxy_send_timeout 360;
                	proxy_http_version 1.1;
                	proxy_set_header Host $host;
                }
	}

	server {
		listen 443 ssl;
                server_name  hrm.suifangyun.com;
                access_log logs/hrm.suifangyun.com.log main;
                ssl_certificate        ssl/hrm.suifangyun.com.crt;
                ssl_certificate_key    ssl/hrm.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers       'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                                proxy_pass http://hrmtest;
                                proxy_http_version 1.1;
                                proxy_set_header X-real-ip $remote_addr;
                                proxy_set_header X-Forwarded-For $remote_addr;
                }
	#    websocket service
        	location ^~/wsapp/ {
                	proxy_read_timeout 360;
                	proxy_send_timeout 360;
                	proxy_http_version 1.1;
                	proxy_set_header Upgrade $http_upgrade;
                	proxy_set_header Connection "upgrade";
                	proxy_set_header X-real-ip $remote_addr;
                	proxy_set_header X-Forwarded-For $remote_addr;
                	proxy_pass_header X-XSRF-TOKEN;
                	proxy_set_header Host $host;
			proxy_pass http://hrmtest;
                }
	}

 	server {
                listen       80;
                server_name  eureka.shukangyun.com;
                access_log logs/eureka.shukangyun.com.log main;
                location / {
                        proxy_pass http://eurekadev;
                }
        }
 	server {
                listen       80;
                server_name  cAdvisor.shukangyun.com;
                access_log logs/eureka.shukangyun.com.log main;
                location / {
                        proxy_pass http://cAdvisor;
                }
        }
 	server {
                listen       80;
                server_name  eureka.suifangyun.com;
                access_log logs/eureka.suifangyun.com.log main;
                location / {
                        proxy_pass http://eurekatest;
                }
        }

 	server {
                listen       80;
                server_name  snsconsole.shukangyun.com;
                access_log logs/snsconsole.shukangyun.com.log main;
                location / {
                        proxy_pass http://snsconsoledev;
                }
        }
 	server {
                listen       80;
                server_name  snsconsole.suifangyun.com;
                access_log logs/snsconsole.suifangyun.com.log main;
                location / {
                        proxy_pass http://snsconsoletest;
                }
        }

        server {
                listen 80;
                server_name mp.suifangyun.com;
                access_log logs/mp.suifangyun.com.log main;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://patienttest;
                }
		location ^~ /sports/ {
			proxy_pass http://sporttest;
		}   
		location ^~ /services/ {
                        proxy_pass http://patienttest;
                }

		location ^~ /i/ {
                        proxy_pass http://patienttest;
                }
		location ^~ /m/ {
                        proxy_pass http://patienttest;
                }
		location ^~  /Home/SnsTestV1 {
                        proxy_pass http://snstest;
                }
        }
        server {
                listen 443 ssl;
                server_name mp.suifangyun.com;
                access_log logs/mp.suifangyun.com.log main;
                ssl_certificate     ssl/mp.suifangyun.com.pem;
                ssl_certificate_key  ssl/mp.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;

                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://patienttest;
                }
		location ^~ /sports/ {
			proxy_pass http://sporttest;
		}   
		location ^~ /services/ {
                        proxy_pass http://patienttest;
                }

		location ^~ /i/ {
                        proxy_pass http://patienttest;
                }
		location ^~ /m/ {
                        proxy_pass http://patienttest;
                }
		location ^~  /Home/SnsTestV1 {
                        proxy_pass http://snstest;
                }
        }

        server {
                listen 80;
                server_name mp.shukangyun.com;
                access_log logs/mp.shukangyun.com.log main;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://sportdev;
                }   
		location ^~ /services/ {
                        proxy_pass http://patientdev;
                }

		location ^~ /i/ {
                        proxy_pass http://patientdev;
                }

		location ^~ /m/ {
                        proxy_pass http://patientdev;
                }
		location ^~  /Home/SnsDevV1 {
                        proxy_pass http://snsdev;
		}
        }      
        server {
                listen 443 ssl;
                server_name mp.shukangyun.com;
                access_log logs/mp.shukangyun.com.log main;
                ssl_certificate     ssl/mp.shukangyun.com.crt;
                ssl_certificate_key  ssl/mp.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://sportdev;
                }   
		location ^~ /services/ {
                        proxy_pass http://patientdev;
                }

		location ^~ /i/ {
                        proxy_pass http://patientdev;
                }

		location ^~ /m/ {
                        proxy_pass http://patientdev;
                }
		location ^~  /Home/SnsDevV1 {
                        proxy_pass http://snsdev;
		}
	}

        server {
                listen 443 ssl;
                server_name md.suifangyun.com;
                access_log logs/md.suifangyun.com.log main;
                ssl_certificate     ssl/md.suifangyun.com.pem;
                ssl_certificate_key  ssl/md.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers      'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
		#proxy_next_upstream error http_504;
		#proxy_next_upstream_tries 2;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://doctortest;
                }
        }
        server {
                listen 80;
                server_name md.suifangyun.com;
                access_log logs/md.suifangyun.com.log main;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://doctortest;
                }
        }

        server {
                listen 80;
                server_name md.shukangyun.com ;
                access_log logs/md.shukangyun.com.log main;
		#proxy_next_upstream error http_500;
		#proxy_next_upstream_tries 2;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://doctordev;
                }   
        }
        server {
                listen 443 ssl;
                server_name md.shukangyun.com;
                access_log logs/md.shukangyun.com.log main;
                ssl_certificate           ssl/md.shukangyun.com.crt;
                ssl_certificate_key    ssl/md.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers         'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
		#proxy_next_upstream error http_500;
		#proxy_next_upstream_tries 2;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass http://doctordev;
                }   
        }

        server {
                listen 443 ssl;
                server_name  xcxdev.suifangyun.com;
                access_log logs/xcxdev.suifangyun.com.log main;
                ssl_certificate           ssl/xcxdev.suifangyun.com.crt;
                ssl_certificate_key    ssl/xcxdev.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers         'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                        proxy_pass http://xcxdev;
                }
        }

        server{
                listen 80;
                server_name git.suifangyun.com;
                location /{
                        allow all;
                        deny            all;
                        root html;
                        proxy_pass http://git;
                }
        }

        server {
                listen       80;
                server_name  jenkins2.suifangyun.com;
                location / {
                        proxy_pass http://jenkins2;
                }
        }
        server {
                listen       80;
                server_name  jenkins.suifangyun.com;
                location / {
                        proxy_pass http://jenkins;
                }
        }

        server {
                listen       	80;
                server_name  	gerrit.suifangyun.com;
                allow 		all;
                deny		all;
                auth_basic 	"Welcomme to Gerrit Code Review Site Running By RecoveryPlus!";
                auth_basic_user_file /home/gerrit2/htpasswd.conf;
                location / {
                        proxy_pass  http://gerrit;
                }
        }

        server {
                listen 80;
                server_name  oam.suifangyun.com;
                access_log logs/oam.suifangyun.com.log main;
                location / {
                        proxy_pass http://oamtest;
                }
        }

        server {
                listen 80;
                server_name  oam.shukangyun.com;
                access_log logs/oam.shukangyun.log main;
                location / {
                        proxy_pass http://oamdev;
                }
        }

        server {
            listen       80 ;
            server_name  hd.shukangyun.com;
            access_log logs/hd.shukangyun.com.log main;
            location / {
                    root   html;
                    index  index.html index.htm;
                    proxy_pass  http://wechatactivitydev;
            }
            location ^~ /m/fee/redirectCallback/bind.do {
                    proxy_pass http://patientdev;
            }
            location ^~ /sports/weChat {
                    proxy_pass http://sportdev;
            }
            location ^~ /postopmall-core {
                    proxy_pass http://mallcoredev;
            }
            location ^~ /recoveryplus-core {
                    proxy_pass http://rpluscoredev;
                    proxy_set_header   Host $host;
            }
            location ^~ /activity {
                    proxy_pass http://operationactivitiesdev;
            }
        }
        server {
            listen       443 ssl ;
            server_name  hd.shukangyun.com;
            access_log logs/hd.shukangyun.com.log main;
            ssl_certificate      ssl/hd.shukangyun.com.crt;
            ssl_certificate_key  ssl/hd.shukangyun.com.key;
            ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
            ssl_ciphers         'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
            ssl_prefer_server_ciphers  on;
            location / {
                    root   html;
                    index  index.html index.htm;
                    proxy_pass  http://wechatactivitydev;
            }
            location ^~ /m/fee/redirectCallback/bind.do {
                    proxy_pass http://patientdev;
            }
            location ^~ /sports/weChat {
                    proxy_pass http://sportdev;
            }
            location ^~ /postopmall-core {
                    proxy_pass http://mallcoredev;
            }
            location ^~ /recoveryplus-core {
                    proxy_pass http://rpluscoredev;
                    proxy_set_header        Host $host;
            }
            location ^~ /activity {
                    proxy_pass http://operationactivitiesdev;
            }
        }
        server {
                listen       443 ssl;
                server_name  hd.suifangyun.com;
                access_log logs/hd.suifangyun.com.log main;
                ssl_certificate      ssl/hd.suifangyun.com.pem;
                ssl_certificate_key  ssl/hd.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers         'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;

                location / {
                root   html;
                index  index.html index.htm;
                        proxy_pass  http://wechatactivitytest;
                }
        }
        server {
                listen       80;
                server_name  hd.suifangyun.com;
                access_log logs/hd.suifangyun.com.log main;

                location / {
                root   html;
                index  index.html index.htm;
                        proxy_pass  http://wechatactivitytest;
                }
        }

	
        upstream monitordev{
        	server 10.66.186.199:20001;
	} 
	server{
		listen 80;
		server_name monitor.shukangyun.com;
		location /{
			root html;
			proxy_pass http://monitordev;
		}
	}
        upstream monitortest{
        	server 10.66.186.199:20002;
	} 
	server{
		listen 80;
		server_name monitor.suifangyun.com;
		location /{
			root html;
			proxy_pass http://monitortest;
		}
	}
        upstream managertest{
        	server 10.31.242.110:8102;
	} 
	server{
		listen 80;
		server_name manager.suifangyun.com;
		location /{
			root html;
			proxy_pass http://managertest;
		}
	}

        upstream turbinedev{
        	server 10.66.186.199:20201;
	} 
	server{
		listen 80;
		server_name turbine.shukangyun.com;
		location /{
			index hystrix;
			proxy_pass http://turbinedev;
		}
	}
        upstream authdev{
        	server 192.168.100.72:20030;
	} 
	server{
		listen 80;
		server_name auth.shukangyun.com;
		location /{
			index hystrix;
			proxy_pass http://authdev;
		}
	}
        upstream orgdev{
        	server 192.168.100.72:20050;
	} 
	upstream orgtest{
        	server 192.168.100.71:20050;
	} 
	server{
		listen 80;
		server_name org.shukangyun.com;
		location /{
			index hystrix;
			proxy_pass http://orgdev;
		}
	}
        upstream identitydev{
        	server 192.168.100.72:20040;
	} 
	server{
		listen 80;
		server_name identity.shukangyun.com;
		location /{
			index hystrix;
			proxy_pass http://identitydev;
		}
	}

        server {
                listen       80;
                server_name  cbdiet.suifangyun.com;
                location / {
                        proxy_pass http://rwatcher_native;
                }
                location /api/organizations {
                        proxy_pass http://orgtest;
                }
                location = /food/foodComponentsByIdList {
                        proxy_pass http://rwatcher_native;
                }
                #location = /pay/preOrder {
                #        proxy_pass http://rwatcher_native;
                #}
                location ^~ /ndPHxZXgNl.txt {
                                root html;
                }
                location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt {
                                root html;
                }
                #rewrite ^(.*)$  https://$host$1 permanent;
        }
        server {
                listen       443 ssl;
                server_name  cbdiet.suifangyun.com;
                access_log logs/ssl.cbdiet.suifangyun.com.log main;
                ssl_certificate      ssl/cbdiet.suifangyun.com.crt;
                ssl_certificate_key  ssl/cbdiet.suifangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers AESGCM:ALL:!DH:!EXPORT:!RC4:+HIGH:!MEDIUM:!LOW:!aNULL:!eNULL;
                ssl_prefer_server_ciphers  on;
                location / {
                        proxy_pass http://rwatcher_native;
                }
                location /api/organizations {
                        proxy_pass http://orgtest;
                }
                location = /food/foodComponentsByIdList {
                        proxy_pass http://rwatcher_native;
                }
                #location = /pay/preOrder {
                #        proxy_pass http://rwatcher_native;
                #}
                location ^~ /ndPHxZXgNl.txt {
                                root html;
                }
                location ^~ /MP_verify_9kzokLuKO5GdnIaw.txt {
                                root html;
                }
        }

  
#------------------未更改的配置---------------------------
        upstream zbjdev{
        	server 10.30.177.111:31000;
	} 
  
        server {
                listen 443 ssl;
                server_name  zbj.shukangyun.com;
                ssl_certificate           ssl/zbj.shukangyun.com.crt;
                ssl_certificate_key    ssl/zbj.shukangyun.com.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers        'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;
                location / {
                        proxy_pass http://zbjdev;
                }
        }

	upstream maven{
		server 10.30.179.199:38881;
	}
	server{
		listen 80;
		server_name maven.suifangyun.com;
		location /{
  			allow   10.30.179.199;
			allow  118.190.118.176;
  			allow   223.85.203.80;
			allow   10.30.212.159;
			allow  121.42.228.167;
  			deny    all;
			root html;
			index  index.html index.htm;
			proxy_pass http://maven;
		}
	}
	upstream postop{
		server 121.42.228.167:82;
	}
	server{
		listen 80;
		server_name www.suifangyun.com;
		location /{
			root www;
			index  index.html index.htm;
			#proxy_pass http://postop;
		}
	}
	upstream apollo{
		server 10.129.23.116:20013;
	}
	server{
		listen 80;
		server_name apollo.suifangyun.com;
		location /{
			root html;
			index  index.html index.htm;
			proxy_pass http://apollo;
		}
	}
#-------------------------------------保留的以前，需要处理------------------------
        upstream operational { 
                server 10.45.228.70:52222;
        }

        upstream operationalactivity {
                server 10.45.228.70:38080;
        }
        upstream hd {
                server 10.29.164.234:8092;
        }
        upstream mp{
                server    10.46.208.239:52001 weight=1;
        }

        upstream sports{
                server 10.46.208.239:53001 weight=1;
                server 10.29.164.234:53001  weight=1;
        }

        upstream mall {
                server   10.30.106.134:7272;
        }

        upstream rplus {
                server   10.30.106.134:7373;
        }

        server {
                listen       80;
                server_name  operational.postop.cn;
                location / {
                        proxy_pass http://operational;
                }
        }

          server {
                listen       80;
                server_name  hd.postop.cn;
                access_log logs/hd.postop.cn.80.log main;
                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass  http://hd;
                }             
                location ^~ /doXtdcJQ86.txt{               
                        root html;
                } 
                location ^~ /ceBXDICb0E.txt{
                        root html;
                }
                location ^~ /ndPHxZXgNl.txt{
                        root html;
                }
                location ^~ /m/fee/redirectCallback/bind.do {
			proxy_redirect http:// https://;	
                        proxy_pass http://mp;
                }
                location ^~ /sports/weChat {
			proxy_redirect http:// https://;	
                        proxy_pass http://sports;
                }
                location ^~ /postopmall-core {
			proxy_redirect http:// https://;	
                        proxy_pass http://mallCore;		
                }
                location ^~ /recoveryplus-core {
			proxy_redirect http:// https://;	
                        proxy_pass http://rplus;
                        proxy_set_header        Host $host;
                }
                location ^~ /activity {
			proxy_redirect http:// https://;	
                        proxy_pass http://operationalactivity;
                }              
                location ^~ /redbag {
                        return 403;
                }              
        }


        server {
                listen       443 ssl;
                server_name  hd.postop.cn;
                access_log logs/hd.postop.cn.log main;
                ssl_certificate      ssl/hd.postop.cn.crt;
                ssl_certificate_key  ssl/hd.postop.cn.key;
                ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
                ssl_ciphers         'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:HIGH:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!CBC:!EDH:!kEDH:!PSK:!SRP:!kECDH';
                ssl_prefer_server_ciphers  on;

                location / {
                        root   html;
                        index  index.html index.htm;
                        proxy_pass  http://hd;
                }                              
                location ^~ /doXtdcJQ86.txt{               
                        root html;
                }
                location ^~ /ceBXDICb0E.txt{
                        root html;
                } 
                location ^~ /ndPHxZXgNl.txt{
                        root html;
                } 
		location ^~ /m/fee/redirectCallback/bind.do {
                        proxy_pass http://mp;
                }
                location ^~ /sports/weChat {
                        proxy_pass http://sports;
                }
                location ^~ /postopmall-core {
                        proxy_pass http://mallCore;
                }
                location ^~ /recoveryplus-core {
                        proxy_pass http://rplus;
                        proxy_set_header        Host $host;
                }
                location ^~ /activity {
                        proxy_pass http://operationalactivity;
                }              
                location ^~ /redbag {
                        return 403;
                }              
        }
    include postop_cn.conf;
}
include ./tcp.conf;